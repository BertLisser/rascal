<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">

<!---- DO NOT EDIT: HTML generated by CourseCompiler ---->


<head>
<title>Rascal/Libraries/Prelude/ParseTree/implode</title>

<meta name="description" content="Rascal/Libraries/Prelude/ParseTree/implode:  Implode a parse tree according to a given ADT.">

<meta name="keywords" content="Rascal/Libraries/Prelude/ParseTree/implode, Rascal, meta-programming, software analysis, software transformation">
<link type="text/css" rel="stylesheet" href="/prelude.css"/>
<link type="text/css" rel="stylesheet" href="/jquery.autocomplete.css"/>
<script type="text/javascript" src="/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="/jquery.colorbox-min.js"></script>
<script type="text/javascript" src="/jquery.cookie.js"></script>
<script type="text/javascript" src="/jquery.jstree.js"></script>
<script type="text/javascript" src="/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/jquery.history.js"></script>
<script type="text/javascript" src="/globals.js"></script>
<script type="text/javascript" src="/prelude.js"></script>
<script type="text/javascript" src="/Rascal/course.js"></script>

</head>
<body>
<table id="container"><tr><td id="tdlogo"><a id="tutorAction" href="/index.html"><img id="leftIcon" height="40" width="40" src="/images/rascal-tutor-small.png"></a></td><td id="tdsearch">
<div id="searchBox">
  <form method="GET" id="searchForm" action="/search"> 
    <img id="searchIcon" height="20" width="20" src="/images/magnify.png">
    <input type="hidden" name="concept" value="Rascal/Libraries/Prelude/ParseTree/implode">
    <input type="text" id="searchField" name="term" autocomplete="off"><br />
    <div id="popups"></div>
  </form>
</div>
         </td></tr><tr><td id="tdnav">
<a id="navPanePlaceHolder" href="/Rascal/navigate.html" >Navigation</a>
<script type="text/javascript"> var navigationPaneSource="/Rascal/navigate.html"; </script></td><td id="tdconcept">
<div id="conceptPane">

<div id="Name">
<span class="sectionHead">Name</span> <a href="/Rascal/Rascal.html">Rascal</a>/<a href="/Rascal/Libraries/Libraries.html">Libraries</a>/<a href="/Rascal/Libraries/Prelude/Prelude.html">Prelude</a>/<a href="/Rascal/Libraries/Prelude/ParseTree/ParseTree.html">ParseTree</a>/<a href="/Rascal/Libraries/Prelude/ParseTree/implode/implode.html">implode</a>
</div>

<div id="Synopsis">
<span class="sectionHead">Synopsis</span>  Implode a parse tree according to a given ADT.

</div>

	                       
                           
                           
<div id="Function">
<span class="sectionHead">Function</span>  <code>&amp;T&lt;:node implode(type[&amp;T&lt;:node] t, Tree tree)</code>

</div>

                           
<div id="Usage">
<span class="sectionHead">Usage</span>  <code>import ParseTree;</code>
 </AUTOINSERTED>

</div>

<div id="Description">
<span class="sectionHead">Description</span>  Given a grammar for a language, its sentences can be parsed and the result is a parse tree
 (or more precisely a value of type <code>Tree</code>). For many applications this is sufficient
 and the results are achieved by traversing and matching them using concrete patterns.
 <br/>
<br/>

 In other cases, the further processing of parse trees is better done in a more abstract form.
 The <a href="http://en.wikipedia.org/wiki/Abstract_syntax">abstract syntax<img src="/images/www-icon.png" with="20" height="20"></a> for a language is a
 data type that is used to represent programs in the language in an <i>abstract</i> form.
 Abstract syntax has the following properties:
 <ul><li> It is "abstract" in the sense that it does not contain textual details such as parentheses,   layout, and the like.
</li>
<li> While a language has one grammar (also known as, <i>concrete syntax</i>) it may have several abstract syntaxes   for different purposes: type analysis, code generation, etc.
</li>
</ul> The function <code>implode</code> bridges the gap between parse tree and abstract syntax tree.
 Given a parse tree and the type of an ADT it traverses them simultaneously and constructs
 an abstract syntax tree (a value of the given ADT type) as follows:
  <ol><li> Literals, layout and empty (i.e. ()) nodes are skipped.</li>
<li> Regular */+ lists are imploded to <code>list</code>s or <code>set</code>s depending on what is    expected in the ADT.
</li>
<li> Ambiguities are imploded to <code>set</code>s.</li>
<li> If a tree's production has no label and a single AST (i.e. non-layout, non-literal) argument   (for instance, an injection), the tree node is skipped, and implosion continues 
   with the lone argument. The same applies to bracket productions, even if they
   are labeled.
</li>
<li> If a tree's production has no label, but more than one argument, the tree is imploded    to a tuple (provided this conforms to the ADT).
</li>
<li> Optionals are imploded to booleans if this is expected in the ADT.   This also works for optional literals, as shown in the example below.
</li>
<li> An optional is imploded to a list with zero or one argument, iff a list   type is expected.
</li>
<li> If the argument of an optional tree has a production with no label, containing   a single list, then this list is spliced into the optional list.
</li>
<li> For trees with (cons-)labeled productions, the corresponding constructor   in the ADT corresponding to the non-terminal of the production is found in
   order to make the AST.
</li>
<li> Unlabeled lexicals are imploded to str, int, real, bool depending on the expected type in   the ADT. To implode lexical into types other than str, the PDB parse functions for 
   integers and doubles are used. Boolean lexicals should match "true" or "false". 
   NB: lexicals are imploded this way, even if they are ambiguous.
</li>
<li> If a lexical tree has a cons label, the tree imploded to a constructor with that name   and a single string-valued argument containing the tree's yield.
</li>
</ol> An <code>IllegalArgument</code> exception is thrown if during implosion a tree is encountered that cannot be
 imploded to the expected type in the ADT. As explained above, this function assumes that the
 ADT type names correspond to syntax non-terminal names, and constructor names correspond 
 to production labels. Labels of production arguments do not have to match with labels
  in ADT constructors.
 <br/>
<br/>

 Finally, source location annotations are propagated as annotations on constructor ASTs. 
 To access them, the user is required to explicitly declare a location annotation on all
 ADTs used in implosion. In other words, for every ADT type <code>T</code>, add:
  <pre class="listing">anno loc T@location;
</pre>
</div>

  	                       
<div id="Examples">
<span class="sectionHead">Examples</span>  <h1>Example for rule 5</h1>
 Given the grammar
 <pre class="listing">syntax IDTYPE = Id ":" Type;
syntax Decls = decls: "declare" {IDTYPE ","}* ";";
</pre> <code>Decls</code> will be imploded as:
 <pre class="listing">data Decls = decls(list[tuple[str,Type]]);
</pre> (assuming Id is a lexical non-terminal).   
  <h1>Example for rule 6</h1>
 Given the grammar
 <pre class="listing">syntax Formal = formal: "VAR"? {Id ","}+ ":" Type;
</pre> The corresponding ADT could be:
 <pre class="listing">data Formal = formal(bool, list[str], Type);
</pre> <h1>Example for rule 8</h1>
 Given the grammar
 <pre class="listing">syntax Tag = "[" {Modifier ","}* "]";
syntax Decl = decl: Tag? Signature Body;
</pre> In this case, a <code>Decl</code> is imploded into the following ADT:
 <pre class="listing">data Decl = decl(list[Modifier], Signature, Body);  
</pre> <h1>Example for rule 9</h1>
 Given the grammar
 <pre class="listing">syntax Exp = left add: Exp "+" Exp;
</pre> Can be imploded into:
 <pre class="listing">data Exp = add(Exp, Exp);
</pre>
</div>

  	                       
  	                       
  	                       
<a id="tutorAction" href="/index.html"><img id="leftIcon" height="40" width="40" src="/images/rascal-tutor-small.png"></a><div id="editMenu">[<a id="editAction" href="/edit?concept=Rascal/Libraries/Prelude/ParseTree/implode&new=false"><b>Edit</b></a>] | 
               [<a id="newAction" href="/edit?concept=Rascal/Libraries/Prelude/ParseTree/implode&new=true"><b>New Subconcept</b></a>] |
               [<a id="compileAction" href="/compile?name=Rascal"><b>Recompile Course</b></a>] |
               [<a id="warnAction" href="/Rascal/warnings.html"><b>Warnings</b></a>]</div>
<span class="editMenuFooter">Is this page unclear, or have you spotted an error? Please add a comment below and help us to improve it. For all other questions and remarks, visit <a href="http://ask.rascal-mpl.org">ask.rascal-mpl.org</a>. </span>
</div>
</td></tr></table>
</body>
</html>